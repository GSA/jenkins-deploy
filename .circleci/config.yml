version: 2
jobs:
  validate_ansible:
    working_directory: /etc/jenkins-deploy
    docker:
      - image: williamyeh/ansible:alpine3
    steps:
      - checkout
      - run:
          name: Check Ansible syntax
          command: cd tests && ansible-playbook --syntax-check test.yml
  validate_terraform:
    working_directory: /etc/jenkins-deploy
    docker:
      - image: hashicorp/terraform
    steps:
      - checkout
      - run:
          name: Check Terraform syntax
          command: cd terraform && terraform validate
workflows:
  version: 2
  build_and_test:
    jobs:
      - validate_ansible
      - validate_terraform
