---
- hosts: all
  name: Set up Jenkins
  remote_user: ec2-user
  become: true
  roles:
    - jdauphant.ssl-certs
    # needs to match repository name
    - role: jenkins-deploy
      # use paths from jdauphant.ssl-certs
      ssl_certificate_path: "{{ ssl_certs_cert_path }}"
      ssl_certificate_key_path: "{{ ssl_certs_privkey_path }}"
  tasks:

    - name: Set up pipeline
      jenkins_job:
        config: "{{ lookup('file', 'files/job.xml') }}"
        name: test-auto
        user: "{{ jenkins_admin_username }}"
        password: "{{ jenkins_admin_password }}"
